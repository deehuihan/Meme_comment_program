<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>æ¸¬é©—çµæœ</title>
    <link rel="stylesheet" href="/static/css/summary.css">
    <link rel="stylesheet" href="/static/css/share_result.css">
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='favicon.png') }}">
    </head>
<body>

    <div class="result-container">
        <h1>ğŸ‰ éŠæˆ²çµæœ </h1>
        <!-- <div class="personality-image-container">
            <img class="personality-image" src="/static/picture/{{personality_animal}}.png">
        </div> -->
        <div class="personality-result">
            <h2>çµæœåˆ†æ: <span id="personalityType" class="highlight-personality">{{personality_description}}</span></h2>
        </div>
        
        <div class="performance-summary">
            <div class="emotion-legend">
                <div class="legend-item active" data-filter="all">
                    <span class="color-swatch all"></span>
                    <span class="legend-text">å…¨éƒ¨</span>
                </div>
                {% if user_percentages is defined %}
                <div class="legend-item" data-filter="è¼•è”‘">
                    <span class="color-swatch contempt"></span>
                    <span class="legend-text">è¼•è”‘ {{ user_percentages['è¼•è”‘'] }}%</span>
                </div>
                <div class="legend-item" data-filter="æ†¤æ€’">
                    <span class="color-swatch anger"></span>
                    <span class="legend-text">æ†¤æ€’ {{ user_percentages['æ†¤æ€’'] }}%</span>
                </div>
                <div class="legend-item" data-filter="å­æƒ¡">
                    <span class="color-swatch disgust"></span>
                    <span class="legend-text">å­æƒ¡ {{ user_percentages['å­æƒ¡'] }}%</span>
                </div>
                <div class="legend-item" data-filter="å…¶ä»–">
                    <span class="color-swatch other"></span>
                    <span class="legend-text">å…¶ä»– {{ user_percentages['å…¶ä»–'] }}%</span>
                </div>
                {% endif %}
            </div>
        </div>
        
        
        <div class="analysis-table">
            {% if all_items|length > 0 %}
            <div class="image-grid">
                {% for item in all_items %}
                <div class="image-item" data-emotion="{{ item.choice }}">
                    <span class="image-number">{{ loop.index }}</span>
                    <div class="image-thumbnail-container">
                        <img src="/summary/images/{{ item.image }}" alt="è¿·å› " class="thumbnail">
                        <div class="emotion-overlay emotion-{{ item.choice|emotion_class }}"></div>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% else %}
                <p class="no-data">ç›®å‰æ²’æœ‰å¯ä¾›åˆ†æçš„åœ–ç‰‡æ•¸æ“šã€‚</p>
            {% endif %}
        </div>
        
        <div class="footer">
            <div class="invitation-section">
                <div class="invitation-text">
                    <h3>é»æ“Šä¸‹æ–¹æŒ‰éˆ•å³å¯é–‹å§‹éŠæˆ²</h3>
                </div>
            
                
                <button class="play-button" onclick="window.location.href='/'">
                    <span class="play-icon">ğŸ®</span> é–‹å§‹éŠæˆ²
                </button>
            </div>
        </div>
        
    </div>

    <script>
        // Filter images by emotion
        document.querySelectorAll('.legend-item').forEach(item => {
            item.addEventListener('click', function() {
                const filter = this.getAttribute('data-filter');
                
                // Remove active class from all legend items
                document.querySelectorAll('.legend-item').forEach(el => {
                    el.classList.remove('active');
                });
                
                // Add active class to clicked item
                this.classList.add('active');
                
                // Filter the image grid
                const imageItems = document.querySelectorAll('.image-item');
                imageItems.forEach(img => {
                    if (filter === 'all' || img.getAttribute('data-emotion') === filter) {
                        img.style.display = '';
                    } else {
                        img.style.display = 'none';
                    }
                });
            });
        });
    </script>

    {% if error_message %}
    <div class="error-message">
        {{ error_message }}
    </div>
    {% endif %}
</body>
</html>
