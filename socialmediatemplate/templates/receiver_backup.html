<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Social - è§€å¯Ÿè€…é é¢</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/receiver.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/context-intro.css') }}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='s_logo.png') }}">

</head>
<body>

    <div id="page-content-wrapper" class="hidden">
        <!-- æƒ…å¢ƒèªªæ˜å€åŸŸ -->
        <div id="context-introduction" class="context-intro">
            <div class="intro-header">
                <h2><i class="fas fa-eye"></i> è§€å¯Ÿè€…éšæ®µ</h2>
            </div>
            
            <div class="intro-content">
                <div class="scenario-description">
                    <h3>è§€å¯Ÿè€…æƒ…å¢ƒ</h3>
                    <p>æƒ³åƒä¸€ä¸‹ï¼Œæ‚¨æ­£åœ¨ç€è¦½ç¤¾ç¾¤åª’é«”ä¸Šçš„æ–°èã€‚å…¶ä¸­ç•™è¨€å› åŒ…å«äººèº«æ”»æ“Šè¨€è«–ï¼Œå·²è¢«å¹³å°è‡ªå‹•è½‰æ›ç‚ºè¿·å› åœ–é¡¯ç¤º</p>
                    
                    <h4>æ‚¨çš„ä»»å‹™ï¼š</h4>
                    <ul>
                        <li>ä»”ç´°é–±è®€æ¯å‰‡æ–°èè²¼æ–‡çš„å…§å®¹</li>
                        <li>è§€å¯Ÿå…¶ä»–ç¶²å‹ä½¿ç”¨è¿·å› åœ–ç‰‡çš„å›æ‡‰æ–¹å¼</li>
                        <li>æ ¹æ“šæ‚¨çš„æ„Ÿå—å¡«å¯«æ¯å‰‡è²¼æ–‡çš„è©•åƒ¹å•å·</li>
                    </ul>
                </div>
                
            </div>
            
            <button class="start-viewing-btn" id="startViewing">
                <i class="fas fa-arrow-right"></i>
                é–‹å§‹è§€çœ‹è²¼æ–‡
            </button>
        </div>
        
        <main class="horizontal-layout" id="main-content" style="display: none;">
            <!-- å·¦å´é‚Šæ¬„ -->
            <div class="left-sidebar">
                <div class="sidebar-section">
                    <div class="user-profile">
                        <div class="user-avatar large">
                            <img class="random-avatar" data-current-user="true" src="" alt="ç”¨æˆ¶">
                        </div>
                        <div class="user-info">
                            <div class="username-display">ç”¨æˆ¶</div>
                            <div class="user-status">ç·šä¸Š</div>
                        </div>
                    </div>
                </div>
                
                <div class="sidebar-section">
                    <h3>å¿«æ·åŠŸèƒ½</h3>
                    <div class="sidebar-menu">
                        <div class="menu-item active">
                            <i class="fas fa-newspaper"></i>
                            <span>å‹•æ…‹æ¶ˆæ¯</span>
                        </div>
                        <div class="menu-item">
                            <i class="fas fa-users"></i>
                            <span>æœ‹å‹</span>
                        </div>
                        <div class="menu-item">
                            <i class="fas fa-bookmark"></i>
                            <span>æˆ‘çš„æœ€æ„›</span>
                        </div>
                        <div class="menu-item">
                            <i class="fas fa-clock"></i>
                            <span>å›æ†¶</span>
                        </div>
                    </div>
                </div>
                
                <div class="sidebar-section">
                    <h3>å»ºè­°è¯çµ¡äºº</h3>
                    <div class="suggested-friends">
                        <div class="friend-suggestion">
                            <div class="user-avatar small">
                                <img class="random-avatar" data-seed="friend1" src="" alt="å»ºè­°æœ‹å‹">
                            </div>
                            <div class="friend-info">
                                <div class="friend-name">æå°æ˜</div>
                                <div class="mutual-friends">2ä½å…±åŒæœ‹å‹</div>
                            </div>
                        </div>
                        <div class="friend-suggestion">
                            <div class="user-avatar small">
                                <img class="random-avatar" data-seed="friend2" src="" alt="å»ºè­°æœ‹å‹">
                            </div>
                            <div class="friend-info">
                                <div class="friend-name">ç‹å°è¯</div>
                                <div class="mutual-friends">3ä½å…±åŒæœ‹å‹</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ä¸­é–“ï¼šå¸–æ–‡å€åŸŸ -->
            <div class="main-content">
                {% if posts_data %}
                    {# å›ºå®šçš„æ‰“äº‚é †åºï¼šé¿å…ç›¸åŒé¡å‹çš„æ–°èé€£çºŒå‡ºç¾ #}
                    {% set fixed_order = [0, 4, 1, 6, 3, 7, 2, 5] %}
                    {% set shuffled_posts = [] %}
                    {% for index in fixed_order %}
                        {% if index < posts_data|length %}
                            {% set _ = shuffled_posts.append(posts_data[index]) %}
                        {% endif %}
                    {% endfor %}
                    {% for post_data in shuffled_posts %}
                    <div class="post news-post{% if loop.index0 == 0 %} active{% endif %}" id="post-{{ loop.index0 }}" data-original-post-id="{{ post_data.original_post_id }}" {% if loop.index0 != 0 %}style="display: none;"{% endif %}>
                        <!-- å¸–å­æ¨™é¡Œå€åŸŸ -->
                        <div class="post-header">
                            <div class="user-avatar medium">
                                <img class="random-avatar news-avatar" data-seed="newsStation{{ loop.index }}" src="" alt="æ–°èå°">
                            </div>
                            <div class="post-meta">
                                <div class="author-name">å°ç£æ–°èç¶²</div>
                                <div class="post-time">{{ loop.index }}å°æ™‚å‰ Â· <i class="fas fa-globe-americas"></i> å…¬é–‹</div>
                            </div>
                            <div class="post-actions">
                                <button class="action-menu-btn">â‹¯</button>
                            </div>
                        </div>

                        <div class="post-content">
                            <img class="post-image" src="{{ url_for('static', filename='news/' + post_data.news_file) }}" data-category="news" alt="æ–°èåœ–ç‰‡">
                        </div>

                        <!-- å¸–å­äº’å‹•çµ±è¨ˆ -->
                        <div class="post-stats">
                            <div class="reactions-count">
                                <span class="reaction-icons">ğŸ‘â¤ï¸ğŸ˜®</span>
                                <span class="count">{{ 45 + loop.index * 23 }}äºº</span>
                            </div>
                            <div class="comments-shares">
                                <span class="comments-count">{{ 12 + loop.index * 7 }}å‰‡ç•™è¨€</span>
                                <span class="shares-count">{{ 3 + loop.index * 2 }}æ¬¡åˆ†äº«</span>
                            </div>
                        </div>

                        <!-- å¸–å­äº’å‹•æŒ‰éˆ• -->
                        <div class="post-actions-bar">
                            <button class="post-action-btn like-btn">
                                <i class="far fa-thumbs-up"></i>
                                <span>è´Š</span>
                            </button>
                            <button class="post-action-btn comment-btn">
                                <i class="far fa-comment"></i>
                                <span>ç•™è¨€</span>
                            </button>
                            <button class="post-action-btn share-btn">
                                <i class="far fa-share"></i>
                                <span>åˆ†äº«</span>
                            </button>
                        </div>

                        <!-- ç¶²å‹ç•™è¨€å€åŸŸ -->
                        <div class="comments-section">
                            <!-- éš¨æ©Ÿç”Ÿæˆçš„ç•™è¨€ -->
                            <div class="comment random-comment">
                                <div class="user-avatar small">
                                    <img class="random-avatar" data-seed="commenter1_{{ loop.index }}" src="" alt="ç•™è¨€è€…">
                                </div>
                                <div class="comment-content">
                                    <div class="comment-bubble">
                                        <div class="comment-author">å¼µå°æ˜</div>
                                        <div class="comment-text">é€™å€‹æ–°èå¾ˆé‡è¦ï¼Œå¤§å®¶è¦é—œæ³¨ï¼</div>
                                    </div>
                                    <div class="comment-actions">
                                        <span class="comment-time">{{ loop.index + 2 }}å°æ™‚å‰</span>
                                        <button class="comment-action">è´Š</button>
                                        <button class="comment-action">å›è¦†</button>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="comment random-comment">
                                <div class="user-avatar small">
                                    <img class="random-avatar" data-seed="commenter2_{{ loop.index }}" src="" alt="ç•™è¨€è€…">
                                </div>
                                <div class="comment-content">
                                    <div class="comment-bubble">
                                        <div class="comment-author">æ—å°èŠ³</div>
                                        <div class="comment-text">æ„Ÿè¬åˆ†äº«é€™å€‹è³‡è¨Š ğŸ‘</div>
                                    </div>
                                    <div class="comment-actions">
                                        <span class="comment-time">{{ loop.index + 1 }}å°æ™‚å‰</span>
                                        <button class="comment-action">è´Š</button>
                                        <button class="comment-action">å›è¦†</button>
                                    </div>
                                </div>
                            </div>

                            <!-- ç ”ç©¶ç”¨çš„ç‰¹å®šç•™è¨€ï¼ˆè¿·å› åœ–/åŸå§‹æ–‡å­—ï¼‰ -->
                            <div class="comment research-comment">
                                <div class="user-avatar small">
                                    <img class="random-avatar" data-seed="research_commenter_{{ loop.index }}" src="" alt="ç•™è¨€è€…">
                                </div>
                                <div class="comment-content">
                                    <div class="comment-bubble">
                                        <div class="comment-author">ç‹å¤§è¯</div>
                                        <div class="comment-display">
                                            <!-- è¿·å› åœ–è¦–åœ– -->
                                            <div class="meme-view">
                                                {% if post_data.recommended_memes and post_data.recommended_memes|length > 0 %}
                                                <img class="meme-image" 
                                                     src="{{ url_for('static', filename='meme_50/' + post_data.recommended_memes[0].filename) }}" 
                                                     alt="{{ post_data.recommended_memes[0].name }}">
                                                {% else %}
                                                <div class="text-comment">{{ post_data.comment }}</div>
                                                {% endif %}
                                            </div>
                                            
                                            <!-- åŸå§‹ç•™è¨€è¦–åœ– - éš±è—ç‹€æ…‹ -->
                                            <div class="text-view" style="display: none;">
                                                <div class="original-comment-text">{{ post_data.comment }}</div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="comment-actions">
                                        <span class="comment-time">{{ loop.index }}å°æ™‚å‰</span>
                                        <button class="comment-action like-comment" data-likes="{{ 5 + loop.index * 3 }}">
                                            <i class="far fa-thumbs-up"></i> {{ 5 + loop.index * 3 }}
                                        </button>
                                        <button class="comment-action">å›è¦†</button>
                                        <button class="toggle-comment-btn" data-current-view="meme">
                                            æŸ¥çœ‹åŸå§‹ç•™è¨€
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- æ›´å¤šéš¨æ©Ÿç•™è¨€ -->
                            <div class="comment random-comment">
                                <div class="user-avatar small">
                                    <img class="random-avatar" data-seed="commenter3_{{ loop.index }}" src="" alt="ç•™è¨€è€…">
                                </div>
                                <div class="comment-content">
                                    <div class="comment-bubble">
                                        <div class="comment-author">é™³å°ç¾</div>
                                        <div class="comment-text">æœ‰æ²’æœ‰æ›´å¤šç›¸é—œçš„è³‡è¨Šï¼Ÿ</div>
                                    </div>
                                    <div class="comment-actions">
                                        <span class="comment-time">{{ loop.index - 1 }}å°æ™‚å‰</span>
                                        <button class="comment-action">è´Š</button>
                                        <button class="comment-action">å›è¦†</button>
                                    </div>
                                </div>
                            </div>

                            <!-- æ–°å¢ç•™è¨€å€åŸŸ -->
                            <div class="add-comment">
                                <div class="user-avatar small">
                                    <img class="random-avatar" data-current-user="true" src="" alt="ç”¨æˆ¶">
                                </div>
                                <div class="comment-input-container">
                                    <input type="text" class="comment-input" placeholder="ç•™ä¸‹æ‚¨çš„æƒ³æ³•...">
                                    <button class="comment-submit">
                                        <i class="fas fa-paper-plane"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                {% endif %}
            </div>

            <!-- å³å´é‚Šæ¬„ -->
            <div class="right-sidebar">
                <div class="sidebar-section">
                    <h3>è´ŠåŠ©å•†å»£å‘Š</h3>
                    <div class="ad-container">
                        <img src="https://via.placeholder.com/250x150/e0e0e0/888888?text=å»£å‘Š" alt="å»£å‘Š">
                        <div class="ad-text">
                            <h4>æœ€æ–°å„ªæƒ æ´»å‹•</h4>
                            <p>é™æ™‚ç‰¹åƒ¹ä¸­ï¼Œç«‹å³æ¶è³¼ï¼</p>
                        </div>
                    </div>
                </div>
                
                <div class="sidebar-section">
                    <h3>ç†±é–€è©±é¡Œ</h3>
                    <div class="trending-topics">
                        <div class="topic-item">
                            <span class="hashtag">#å°ç£æ–°è</span>
                            <span class="topic-count">12.5K è¨è«–</span>
                        </div>
                        <div class="topic-item">
                            <span class="hashtag">#ç¤¾æœƒè­°é¡Œ</span>
                            <span class="topic-count">8.3K è¨è«–</span>
                        </div>
                        <div class="topic-item">
                            <span class="hashtag">#ç”Ÿæ´»åˆ†äº«</span>
                            <span class="topic-count">5.7K è¨è«–</span>
                        </div>
                        <div class="topic-item">
                            <span class="hashtag">#ç§‘æŠ€æ–°çŸ¥</span>
                            <span class="topic-count">4.2K è¨è«–</span>
                        </div>
                    </div>
                </div>
                
                <div class="sidebar-section">
                    <h3>æ´»å‹•ä¸­çš„æœ‹å‹</h3>
                    <div class="online-friends">
                        <div class="friend-item">
                            <div class="user-avatar xsmall">
                                <img class="random-avatar" data-seed="online1" src="" alt="ç·šä¸Šæœ‹å‹">
                                <div class="online-indicator"></div>
                            </div>
                            <span class="friend-name">åŠ‰å°å¼·</span>
                        </div>
                        <div class="friend-item">
                            <div class="user-avatar xsmall">
                                <img class="random-avatar" data-seed="online2" src="" alt="ç·šä¸Šæœ‹å‹">
                                <div class="online-indicator"></div>
                            </div>
                            <span class="friend-name">é»ƒå°é›¯</span>
                        </div>
                        <div class="friend-item">
                            <div class="user-avatar xsmall">
                                <img class="random-avatar" data-seed="online3" src="" alt="ç·šä¸Šæœ‹å‹">
                                <div class="online-indicator"></div>
                            </div>
                            <span class="friend-name">è”¡å°å®‡</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- å•å·è©•åƒ¹å€åŸŸ -->
            <div class="right-content"
        <main class="horizontal-layout" id="main-content" style="display: none;">
            <!-- å·¦å´ï¼šå¸–æ–‡å€åŸŸ -->
            <div class="left-content">
                {% if posts_data %}
                    {# å›ºå®šçš„æ‰“äº‚é †åºï¼šé¿å…ç›¸åŒé¡å‹çš„æ–°èé€£çºŒå‡ºç¾ #}
                    {% set fixed_order = [0, 4, 1, 6, 3, 7, 2, 5] %}
                    {% set shuffled_posts = [] %}
                    {% for index in fixed_order %}
                        {% if index < posts_data|length %}
                            {% set _ = shuffled_posts.append(posts_data[index]) %}
                        {% endif %}
                    {% endfor %}
                    {% for post_data in shuffled_posts %}
                    <div class="post news-post{% if loop.index0 == 0 %} active{% endif %}" id="post-{{ loop.index0 }}" data-original-post-id="{{ post_data.original_post_id }}" {% if loop.index0 != 0 %}style="display: none;"{% endif %}>
                        <!-- å¸–å­æ¨™é¡Œå€åŸŸ -->
                        <div class="post-header">
                            <div class="user-avatar medium">
                                <img class="random-avatar" data-seed="newsStation{{ loop.index }}" src="" alt="æ–°èå°">
                            </div>
                            <div class="post-meta">
                                <div class="author-name">æ–°èå°</div>
                                <div class="post-time">{{ loop.index }}å°æ™‚å‰</div>
                            </div>
                            <div class="post-actions">
                                <button class="action-menu-btn">â‹¯</button>
                            </div>
                        </div>

                        <div class="post-content">
                            <img class="post-image" src="{{ url_for('static', filename='news/' + post_data.news_file) }}" data-category="news" alt="æ–°èåœ–ç‰‡">
                        </div>

                        <!-- å¸–å­äº’å‹•æŒ‰éˆ• -->
                        <div class="post-actions-bar">
                            <button class="post-action-btn like-btn">
                                <i class="far fa-heart"></i>
                                <span>è´Š</span>
                            </button>
                            <button class="post-action-btn comment-btn">
                                <i class="far fa-comment"></i>
                                <span>ç•™è¨€</span>
                            </button>
                            <button class="post-action-btn share-btn">
                                <i class="far fa-share-square"></i>
                                <span>åˆ†äº«</span>
                            </button>
                        </div>

                        <!-- ç¶²å‹ç•™è¨€å€åŸŸ -->
                        <div class="comment-section-left">
                            <div class="comment">
                                <div class="user-avatar small">
                                    <img class="random-avatar" data-seed="commenter{{ loop.index }}" src="" alt="ç•™è¨€è€…">
                                </div>
                                <div class="comment-content">
                                    <div class="comment-meta">
                                        <div class="comment-author">ç¶²å‹A</div>
                                    </div>
                                    <div class="comment-display">
                                        <!-- è¿·å› åœ–è¦–åœ– -->
                                        <div class="meme-view">
                                            {% if post_data.recommended_memes and post_data.recommended_memes|length > 0 %}
                                            <img class="meme-image" 
                                                 src="{{ url_for('static', filename='meme_50/' + post_data.recommended_memes[0].filename) }}" 
                                                 alt="{{ post_data.recommended_memes[0].name }}">
                                            {% else %}
                                            <div class="text-comment">{{ post_data.comment }}</div>
                                            {% endif %}
                                        </div>
                                        
                                        <!-- åŸå§‹ç•™è¨€è¦–åœ– - æ”¾åœ¨è¿·å› åœ–ä¸‹æ–¹ -->
                                        <div class="text-view" style="display: none;">
                                            <strong>åŸå§‹ç•™è¨€ï¼š</strong>{{ post_data.comment }}
                                        </div>
                                        
                                        <!-- æŒ‰éˆ•å€åŸŸ -->
                                        <div class="comment-actions">
                                            <button class="action-btn toggle-comment-btn" data-current-view="meme">
                                                æŸ¥çœ‹åŸå§‹ç•™è¨€
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                {% endif %}
            </div>

            <!-- å³å´ï¼šå•å·è©•åƒ¹å€åŸŸ -->
            <div class="right-content">
                {% if posts_data %}
                    {# ä½¿ç”¨èˆ‡å·¦å´ç›¸åŒçš„å›ºå®šé †åº #}
                    {% set fixed_order = [0, 4, 1, 6, 3, 7, 2, 5] %}
                    {% set shuffled_posts = [] %}
                    {% for index in fixed_order %}
                        {% if index < posts_data|length %}
                            {% set _ = shuffled_posts.append(posts_data[index]) %}
                        {% endif %}
                    {% endfor %}
                    <!-- Panel 0 -->
                    <div class="interaction-panel active" id="panel-0">
                        <div class="receiver-survey-section" data-post-id="{{ shuffled_posts[0].post_id }}">
                            <div class="survey-header">
                                <h4>è«‹è©•åƒ¹é€™å€‹è¿·å› åœ–ç•™è¨€</h4>
                            </div>
                            <div class="survey-questions">
                                <!-- Q1 -->
                                <div class="question-group">
                                    <div class="question-text">
                                        è«‹è©•ä¼°é€™å‰‡åŸå§‹ç•™è¨€çš„æ”»æ“Šæ€§ç¨‹åº¦
                                    </div>
                                    <div class="scale-container">
                                        <div class="scale-labels">
                                            <span class="scale-label">1-å®Œå…¨ä¸å…·æ”»æ“Šæ€§</span>
                                            <span class="scale-label">7-æ¥µå…·æ”»æ“Šæ€§</span>
                                        </div>
                                        <div class="scale-controls">
                                            <input type="range" class="likert-scale" min="1" max="7" value="4" data-question="q1">
                                            <div class="scale-value">4</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Q2 -->
                                <div class="question-group">
                                    <div class="question-text">
                                        è«‹è©•ä¼°é€™å¼µè¿·å› ç‰ˆæœ¬çš„æ”»æ“Šæ€§ç¨‹åº¦
                                    </div>
                                    <div class="scale-container">
                                        <div class="scale-labels">
                                            <span class="scale-label">1-å®Œå…¨ä¸å…·æ”»æ“Šæ€§</span>
                                            <span class="scale-label">7-æ¥µå…·æ”»æ“Šæ€§</span>
                                        </div>
                                        <div class="scale-controls">
                                            <input type="range" class="likert-scale" min="1" max="7" value="4" data-question="q2">
                                            <div class="scale-value">4</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Q3 -->
                                <div class="question-group">
                                    <div class="question-text">
                                        é€™å¼µè¿·å› åœ–æ‰€è¡¨é”çš„æƒ…ç·’èˆ‡åŸå§‹ç•™è¨€æ˜¯å¦ç›¸ç¬¦ï¼Ÿ
                                    </div>
                                    <div class="scale-container">
                                        <div class="scale-labels">
                                            <span class="scale-label">1-å®Œå…¨ä¸ç›¸ç¬¦</span>
                                            <span class="scale-label">7-å®Œå…¨ç›¸ç¬¦</span>
                                        </div>
                                        <div class="scale-controls">
                                            <input type="range" class="likert-scale" min="1" max="7" value="4" data-question="q3">
                                            <div class="scale-value">4</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="survey-submit">
                                <button class="submit-receiver-survey-btn">æäº¤</button>
                            </div>
                        </div>
                    </div>

                    <!-- Panel 1-7 -->
                    {% for i in range(1, shuffled_posts|length) %}
                    <div class="interaction-panel" id="panel-{{ i }}" style="display: none;">
                        <div class="receiver-survey-section" data-post-id="{{ shuffled_posts[i].post_id }}">
                            <div class="survey-header">
                                <h4>è«‹è©•åƒ¹é€™å€‹è¿·å› åœ–ç•™è¨€</h4>
                            </div>
                            <div class="survey-questions">
                                <!-- Q1 -->
                                <div class="question-group">
                                    <div class="question-text">
                                        è«‹è©•ä¼°é€™å‰‡åŸå§‹ç•™è¨€çš„æ”»æ“Šæ€§ç¨‹åº¦
                                    </div>
                                    <div class="scale-container">
                                        <div class="scale-labels">
                                            <span class="scale-label">1-å®Œå…¨ä¸å…·æ”»æ“Šæ€§</span>
                                            <span class="scale-label">7-æ¥µå…·æ”»æ“Šæ€§</span>
                                        </div>
                                        <div class="scale-controls">
                                            <input type="range" class="likert-scale" min="1" max="7" value="4" data-question="q1">
                                            <div class="scale-value">4</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Q2 -->
                                <div class="question-group">
                                    <div class="question-text">
                                        è«‹è©•ä¼°é€™å¼µè¿·å› ç‰ˆæœ¬çš„æ”»æ“Šæ€§ç¨‹åº¦
                                    </div>
                                    <div class="scale-container">
                                        <div class="scale-labels">
                                            <span class="scale-label">1-å®Œå…¨ä¸å…·æ”»æ“Šæ€§</span>
                                            <span class="scale-label">7-æ¥µå…·æ”»æ“Šæ€§</span>
                                        </div>
                                        <div class="scale-controls">
                                            <input type="range" class="likert-scale" min="1" max="7" value="4" data-question="q2">
                                            <div class="scale-value">4</div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Q3 -->
                                <div class="question-group">
                                    <div class="question-text">
                                        é€™å¼µè¿·å› åœ–æ‰€è¡¨é”çš„æƒ…ç·’èˆ‡åŸå§‹ç•™è¨€æ˜¯å¦ç›¸ç¬¦ï¼Ÿ
                                    </div>
                                    <div class="scale-container">
                                        <div class="scale-labels">
                                            <span class="scale-label">1-å®Œå…¨ä¸ç›¸ç¬¦</span>
                                            <span class="scale-label">7-å®Œå…¨ç›¸ç¬¦</span>
                                        </div>
                                        <div class="scale-controls">
                                            <input type="range" class="likert-scale" min="1" max="7" value="4" data-question="q3">
                                            <div class="scale-value">4</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="survey-submit">
                                <button class="submit-receiver-survey-btn">æäº¤</button>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                {% else %}
                    <div class="interaction-panel active">
                        <div class="receiver-survey-section">
                            <h4>ç›®å‰æ²’æœ‰æ–°èè²¼æ–‡ã€‚è«‹å°‡åœ–ç‰‡æ”¾å…¥ static/news è³‡æ–™å¤¾ã€‚</h4>
                        </div>
                    </div>
                {% endif %}
            </div>
        </main>

        <!-- åº•éƒ¨å°èˆª -->
        <div class="post-navigation">
            <div class="nav-dots">
                {% for i in range(8) %}
                <div class="nav-dot" data-post-index="{{ i }}">
                    <span class="dot-number">{{ i + 1 }}</span>
                </div>
                {% endfor %}
            </div>
            <div class="nav-progress">
                <span class="current-post">1</span> / 8
            </div>
        </div>
    </div>
    </div>

    <script>
        // Check if user is logged in
        document.addEventListener('DOMContentLoaded', function() {
            const username = localStorage.getItem('socialUserId');
            console.log('Receiver page loaded, username:', username);
            const pageContentWrapper = document.getElementById('page-content-wrapper');
            
            if (!username) {
                // No username, redirect to input page
                console.log('No username found, redirecting to input');
                window.location.href = '/';
                return;
            }
            
            // User has username, show page content
            console.log('User authenticated, showing receiver content');
            if (pageContentWrapper) {
                pageContentWrapper.classList.remove('hidden');
            }
        });
        
        // è¨­ç½®åˆ‡æ›ç•™è¨€å’Œè¿·å› åœ–çš„åŠŸèƒ½
        function setupToggleCommentHandlers() {
            const toggleButtons = document.querySelectorAll('.toggle-comment-btn');
            
            toggleButtons.forEach(btn => {
                btn.addEventListener('click', function() {
                    const commentContent = this.closest('.comment-content');
                    const memeView = commentContent.querySelector('.meme-view');
                    const textView = commentContent.querySelector('.text-view');
                    const currentView = this.dataset.currentView;
                    
                    if (currentView === 'meme') {
                        // åˆ‡æ›åˆ°åŸå§‹ç•™è¨€è¦–åœ–
                        memeView.style.display = 'none';
                        textView.style.display = 'block';
                        this.textContent = 'æŸ¥çœ‹è¿·å› åœ–';
                        this.dataset.currentView = 'text';
                    } else {
                        // åˆ‡æ›åˆ°è¿·å› åœ–è¦–åœ–
                        memeView.style.display = 'block';
                        textView.style.display = 'none';
                        this.textContent = 'æŸ¥çœ‹åŸå§‹ç•™è¨€';
                        this.dataset.currentView = 'meme';
                    }
                });
            });
        }
    </script>
    
    <script src="{{ url_for('static', filename='js/receiver.js') }}"></script>
</body>
</html>